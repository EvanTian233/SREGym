#!/usr/bin/env python3
import sys
from typing import List, Optional

from windowed_file import WindowedFile  # type: ignore

from clients.langgraph_agent.k8s_agent import State


def goto_line(state: State, line_number: Optional[int] = None) -> int:
    if line_number is None:
        print("Usage: goto <line_number>")
        return 1

    try:
        line_number = int(line_number)
    except ValueError:
        print("Usage: goto <line>")
        print("Error: <line> must be a number")
        return 1

    curr_file = str(state["curr_file"])
    wf = WindowedFile(curr_file)

    if line_number > wf.n_lines:
        print(f"Error: <line> must be less than or equal to {wf.n_lines}")
        return 1

    # Convert from 1-based line numbers (user input) to 0-based (internal representation)
    wf.goto(line_number - 1, mode="top")
    wf.print_window()
